

#pipeline name
#pipleline branch
#git source
#git credentials
#secure variable
#material
#stage
#job
#gocd agent name

format_version: 9
pipelines:
  Micronaut-Docker-Build:
#    label_template: "${mygit[:8]}"
#    lock_behavior: none
#    parameters: # list of parameters that can be configured for a pipeline
#      param1: value1
#    environments:
#      - Dev_Environment
    materials:
      mygit: # this is the name of material, the name can contain only of alphanumeric & underscore characters
        # keyword git says about type of material and url at once
        git: https://github.com/RohitPhargade/KafkaDemoMicronaut.git
        branch: main
#      myupstream: # this name does not matter, but there should be no 2 materials with the same name
        # type is optional here, material type is implied based on presence of pipeline and stage fields
        # type: dependency
#        pipeline: pipe2
#        stage: test
#    materials:
#      - git: "https://github.com/RohitPhargade/KafkaDemoMicronaut.git"
#        branch: main
    resources:
      - name: Docker-Agent
        type: agent
    stages:
      Build-and-Push:
        clean_workspace: true
        jobs:
          Docker-Build-and-Push:
            tasks:
              - exec:
                  command: "make all"
#                  arguments: ["all"]
#            environment_variables:
#              DOCKER_REGISTRY: "your-docker-registry"
#              IMAGE_NAME: "your-image-name"
#              IMAGE_TAG: "latest"
#            secure_variables:
#              DOCKER_USERNAME:
#                encrypted_value: "encrypted-username"
#              DOCKER_PASSWORD:
#                encrypted_value: "encrypted-password"
            resources:
              - MSI
